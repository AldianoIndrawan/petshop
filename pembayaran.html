<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Silahkan Lakukan Transaksi</title>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap');

  body {
    font-family: 'Poppins', sans-serif;
    background: linear-gradient(135deg, #74ebd5 0%, #ACB6E5 100%);
    margin: 0;
    padding: 20px;
    color: #2c3e50;
  }
  h1 {
    text-align: center;
    margin-bottom: 30px;
    font-weight: 800;
    font-size: 2.5rem;
    color: #fff;
    text-shadow: 2px 2px 6px rgba(1,10,21,4.3);
  }
  .container {
    max-width: 960px;
    margin: 0 auto;
    background: #fff;
    border-radius: 20px;
    padding: 40px 50px;
    box-shadow: 0 15px 40px rgba(0,0,0,0.2);
    transition: transform 0.3s ease, box-shadow 0.3s ease;
  }
  .container:hover {
    transform: translateY(-5px);
    box-shadow: 0 25px 60px rgba(0,0,0,0.3);
  }
  label {
    display: block;
    font-weight: 700;
    margin-top: 20px;
    margin-bottom: 8px;
    color: #34495e;
  }
  input[type="text"],
  input[type="number"],
  input[type="date"] {
    width: 100%;
    padding: 14px 18px;
    font-size: 1.1rem;
    border: 2px solid #ddd;
    border-radius: 12px;
    transition: border-color 0.4s ease, box-shadow 0.4s ease;
    box-sizing: border-box;
    background: #fefefe;
  }
  input[type="text"]:focus,
  input[type="number"]:focus,
  input[type="date"]:focus {
    border-color: #16a085;
    box-shadow: 0 0 12px #16a085aa;
    outline: none;
    background: #fcfff9;
  }
  .form-row {
    display: flex;
    gap: 20px;
    flex-wrap: wrap;
  }
  .form-group {
    flex: 1 1 200px;
  }
  button {
    margin-top: 32px;
    background: linear-gradient(45deg, #16a085, #27ae60);
    color: white;
    border: none;
    padding: 16px 30px;
    border-radius: 16px;
    font-weight: 800;
    font-size: 1.15rem;
    cursor: pointer;
    box-shadow: 0 6px 18px rgba(39,174,96,0.6);
    user-select: none;
    transition: background 0.3s ease, box-shadow 0.3s ease;
  }
  button:hover:not(:disabled) {
    background: linear-gradient(45deg, #27ae60, #16a085);
    box-shadow: 0 8px 24px rgba(39,174,96,0.9);
  }
  button:disabled {
    background-color: #95a5a6;
    box-shadow: none;
    cursor: not-allowed;
  }
  table {
    margin-top: 36px;
    width: 100%;
    border-collapse: separate;
    border-spacing: 0 10px;
  }
  thead {
    background-color: #16a085;
    color: white;
    border-radius: 16px;
  }
  thead tr th:first-child {
    border-top-left-radius: 16px;
    border-bottom-left-radius: 16px;
  }
  thead tr th:last-child {
    border-top-right-radius: 16px;
    border-bottom-right-radius: 16px;
  }
  th, td {
    padding: 16px 18px;
    text-align: left;
    font-weight: 600;
  }
  tbody tr {
    background: #ecf9f5;
    box-shadow: 0 8px 20px rgba(22,160,133,0.12);
    border-radius: 16px;
    transition: background-color 0.3s ease;
  }
  tbody tr:hover {
    background-color: #d1f0e4;
  }
  tbody tr td:first-child {
    border-top-left-radius: 16px;
    border-bottom-left-radius: 16px;
  }
  tbody tr td:last-child {
    border-top-right-radius: 16px;
    border-bottom-right-radius: 16px;
  }
  .remove-btn {
    background: #e74c3c;
    color: #fff;
    border: none;
    padding: 8px 14px;
    border-radius: 12px;
    font-weight: 700;
    cursor: pointer;
    box-shadow: 0 4px 12px rgba(231,76,60,0.7);
    transition: background-color 0.3s ease, box-shadow 0.3s ease;
    user-select: none;
  }
  .remove-btn:hover {
    background: #c0392b;
    box-shadow: 0 6px 18px rgba(192,57,43,0.9);
  }
  .total-row {
    font-weight: 800;
    font-size: 1.35rem;
    background-color: #d1f0e4;
    border-radius: 16px;
  }
  .total-row td {
    padding-top: 22px;
    padding-bottom: 22px;
  }
  .summary {
    margin-top: 50px;
    padding: 32px;
    background: #16a085;
    border-radius: 20px;
    color: #ecf9f5;
    box-shadow: 0 20px 40px rgba(22,160,133,0.6);
  }
  .summary h2 {
    margin-top: 0;
    font-weight: 900;
    font-size: 2rem;
    letter-spacing: 1.1px;
    margin-bottom: 25px;
  }
  .summary p {
    font-weight: 600;
    font-size: 1.1rem;
    margin: 5px 0 18px 0;
  }
  .summary table {
    box-shadow: none;
    border-spacing: 0 8px;
  }
  .summary thead {
    background-color: #14b99a;
  }
  .summary tbody tr {
    background-color: #1abc9c;
    color: #fff;
  }
  .summary tbody tr:hover {
    background-color: #28d3ad;
  }
  .summary .total-row {
    font-size: 1.5rem;
    background-color: #159f86;
    font-weight: 900;
  }
  @media (max-width: 720px) {
    .form-row {
      flex-direction: column;
    }
    .form-group {
      flex: 1 1 100%;
    }
    .container {
      padding: 30px 20px 40px 20px;
    }
    h1 {
      font-size: 2rem;
    }
  }
</style>
</head>
<body>
<div class="container" role="main" aria-label="Form transaksi pembelian barang">
  <h1>Silahkan Lakukan Transaksi</h1>
  <form id="purchaseForm" autocomplete="off" aria-describedby="formDesc">
    <p id="formDesc" class="sr-only">Masukkan data diri dan detail barang yang akan dibeli.</p>
    <label for="purchaseId">Full Name</label>
    <input type="text" id="purchaseId" placeholder="Masukkan Nama Lengkap" required aria-required="true" aria-describedby="purchaseIdHelp" />
    <small id="purchaseIdHelp" class="sr-only">Isikan Nama Lengkap Anda.</small>

    <label for="purchaseDate">Tanggal Pembelian</label>
    <input type="date" id="purchaseDate" required aria-required="true" aria-describedby="purchaseDateHelp" />
    <small id="purchaseDateHelp" class="sr-only">Pilih tanggal pembelian.</small>

    <label for="supplierName">Lokasi</label>
    <input type="text" id="supplierName" placeholder="Masukkan Lokasi" required aria-required="true" aria-describedby="supplierNameHelp" />
    <small id="supplierNameHelp" class="sr-only">Isikan Lokasi Anda.</small>

    <h3>Tambah Barang</h3>
    <div class="form-row" id="itemInputRow">
      <div class="form-group">
        <label for="itemId">ID Barang</label>
        <input type="text" id="itemId" placeholder="ID Barang" aria-describedby="itemIdHelp" />
        <small id="itemIdHelp" class="sr-only">Isikan ID barang.</small>
      </div>
      <div class="form-group">
        <label for="itemName">Nama Barang</label>
        <input type="text" id="itemName" placeholder="Nama Barang" aria-describedby="itemNameHelp" />
        <small id="itemNameHelp" class="sr-only">Isikan nama barang.</small>
      </div>
      <div class="form-group">
        <label for="itemPrice">Harga Beli (Rp)</label>
        <input type="number" id="itemPrice" placeholder="Harga" min="0" aria-describedby="itemPriceHelp" />
        <small id="itemPriceHelp" class="sr-only">Isikan harga beli per unit barang.</small>
      </div>
      <div class="form-group">
        <label for="itemQty">Jumlah</label>
        <input type="number" id="itemQty" placeholder="Jumlah" min="1" value="1" aria-describedby="itemQtyHelp" />
        <small id="itemQtyHelp" class="sr-only">Isikan jumlah barang yang dibeli.</small>
      </div>
      <div class="form-group" style="align-self: flex-end;">
        <button type="button" id="addItemBtn" aria-label="Tambah barang ke daftar pembelian" disabled>Masukkan Keranjang</button>
      </div>
    </div>

    <table id="itemsTable" style="display:none;" aria-live="polite" aria-label="Daftar barang yang dibeli">
      <thead>
        <tr>
          <th scope="col">ID Barang</th>
          <th scope="col">Nama Barang</th>
          <th scope="col">Harga Beli (Rp)</th>
          <th scope="col">Jumlah</th>
          <th scope="col">Subtotal (Rp)</th>
          <th scope="col">Aksi</th>
        </tr>
      </thead>
      <tbody></tbody>
      <tfoot>
        <tr class="total-row">
          <td colspan="4" style="text-align:right;">Total Pembelian:</td>
          <td id="totalAmount">Rp0</td>
          <td></td>
        </tr>
      </tfoot>
    </table>

    <button type="submit" id="submitPurchaseBtn" disabled aria-disabled="true" aria-label="Selesaikan transaksi pembelian">Selesaikan Pembelian</button>
  </form>

  <section id="purchaseSummary" class="summary" style="display:none;" aria-live="polite" aria-label="Ringkasan transaksi pembelian">
    <h2>Ringkasan Pembelian</h2>
    <p><strong>Name:</strong> <span id="summaryPurchaseId"></span></p>
    <p><strong>Tanggal Pembelian:</strong> <span id="summaryPurchaseDate"></span></p>
    <p><strong>Lokasi:</strong> <span id="summarySupplierName"></span></p>
    <h3>Detail Barang:</h3>
    <table id="summaryItemsTable">
      <thead>
        <tr>
          <th scope="col">ID Barang</th>
          <th scope="col">Nama Barang</th>
          <th scope="col">Harga Beli (Rp)</th>
          <th scope="col">Jumlah</th>
          <th scope="col">Subtotal (Rp)</th>
        </tr>
      </thead>
      <tbody></tbody>
      <tfoot>
        <tr class="total-row">
          <td colspan="4" style="text-align:right;">Total:</td>
          <td id="summaryTotalAmount">Rp0</td>
        </tr>
      </tfoot>
    </table>
  </section>
</div>

<script>
  (() => {
    const purchaseIdInput = document.getElementById('purchaseId');
    const purchaseDateInput = document.getElementById('purchaseDate');
    const supplierNameInput = document.getElementById('supplierName');
    const itemIdInput = document.getElementById('itemId');
    const itemNameInput = document.getElementById('itemName');
    const itemPriceInput = document.getElementById('itemPrice');
    const itemQtyInput = document.getElementById('itemQty');
    const addItemBtn = document.getElementById('addItemBtn');
    const itemsTable = document.getElementById('itemsTable');
    const itemsTableBody = itemsTable.querySelector('tbody');
    const totalAmountElm = document.getElementById('totalAmount');
    const submitPurchaseBtn = document.getElementById('submitPurchaseBtn');
    const purchaseForm = document.getElementById('purchaseForm');

    const purchaseSummary = document.getElementById('purchaseSummary');
    const summaryPurchaseId = document.getElementById('summaryPurchaseId');
    const summaryPurchaseDate = document.getElementById('summaryPurchaseDate');
    const summarySupplierName = document.getElementById('summarySupplierName');
    const summaryItemsTable = document.getElementById('summaryItemsTable');
    const summaryItemsTableBody = summaryItemsTable.querySelector('tbody');
    const summaryTotalAmount = document.getElementById('summaryTotalAmount');

    let items = [];

    function validateItemInputs() {
      return (
        itemIdInput.value.trim() !== '' &&
        itemNameInput.value.trim() !== '' &&
        itemPriceInput.value !== '' &&
        !isNaN(itemPriceInput.value) && Number(itemPriceInput.value) > 0 &&
        itemQtyInput.value !== '' &&
        !isNaN(itemQtyInput.value) && Number(itemQtyInput.value) > 0
      );
    }

    function updateAddItemButtonState() {
      addItemBtn.disabled = !validateItemInputs();
    }

    function updateSubmitPurchaseState() {
      const enable = (
        purchaseIdInput.value.trim() !== '' &&
        purchaseDateInput.value !== '' &&
        supplierNameInput.value.trim() !== '' &&
        items.length > 0
      );
      submitPurchaseBtn.disabled = !enable;
      submitPurchaseBtn.setAttribute('aria-disabled', !enable ? 'true' : 'false');
    }

    function formatRupiah(num) {
      return num.toLocaleString('id-ID', { style: 'currency', currency: 'IDR' }).replace('IDR','Rp');
    }

    function renderItems() {
      itemsTableBody.innerHTML = '';
      let total = 0;

      items.forEach((item, index) => {
        const subtotal = item.price * item.qty;
        total += subtotal;

        const tr = document.createElement('tr');

        tr.innerHTML = `
          <td>${item.id}</td>
          <td>${item.name}</td>
          <td>${formatRupiah(item.price)}</td>
          <td>${item.qty}</td>
          <td>${formatRupiah(subtotal)}</td>
          <td><button type="button" class="remove-btn" data-index="${index}" aria-label="Hapus barang ${item.name} dari daftar pembelian">Hapus</button></td>
        `;
        itemsTableBody.appendChild(tr);
      });

      totalAmountElm.textContent = formatRupiah(total);

      if (items.length > 0) {
        itemsTable.style.display = '';
      } else {
        itemsTable.style.display = 'none';
      }

      updateSubmitPurchaseState();
    }

    function clearItemInputs() {
      itemIdInput.value = '';
      itemNameInput.value = '';
      itemPriceInput.value = '';
      itemQtyInput.value = 1;
      addItemBtn.disabled = true;
    }

    addItemBtn.addEventListener('click', () => {
      if (!validateItemInputs()) return;

      items.push({
        id: itemIdInput.value.trim(),
        name: itemNameInput.value.trim(),
        price: Number(itemPriceInput.value),
        qty: Number(itemQtyInput.value)
      });

      renderItems();
      clearItemInputs();
      itemIdInput.focus();
    });

    itemsTableBody.addEventListener('click', (e) => {
      if (e.target.classList.contains('remove-btn')) {
        const idx = Number(e.target.dataset.index);
        items.splice(idx, 1);
        renderItems();
      }
    });

    purchaseIdInput.addEventListener('input', updateSubmitPurchaseState);
    purchaseDateInput.addEventListener('input', updateSubmitPurchaseState);
    supplierNameInput.addEventListener('input', updateSubmitPurchaseState);

    itemIdInput.addEventListener('input', updateAddItemButtonState);
    itemNameInput.addEventListener('input', updateAddItemButtonState);
    itemPriceInput.addEventListener('input', updateAddItemButtonState);
    itemQtyInput.addEventListener('input', updateAddItemButtonState);

    purchaseForm.addEventListener('submit', (e) => {
      e.preventDefault();

      // Show summary and reset form
      summaryPurchaseId.textContent = purchaseIdInput.value.trim();
      summaryPurchaseDate.textContent = purchaseDateInput.value;
      summarySupplierName.textContent = supplierNameInput.value.trim();
      summaryItemsTableBody.innerHTML = '';

      let total = 0;
      items.forEach((item) => {
        const subtotal = item.price * item.qty;
        total += subtotal;

        const tr = document.createElement('tr');
        tr.innerHTML = `
          <td>${item.id}</td>
          <td>${item.name}</td>
          <td>${formatRupiah(item.price)}</td>
          <td>${item.qty}</td>
          <td>${formatRupiah(subtotal)}</td>
        `;
        summaryItemsTableBody.appendChild(tr);
      });
      summaryTotalAmount.textContent = formatRupiah(total);

      purchaseSummary.style.display = 'block';

      // Scroll smoothly to summary
      purchaseSummary.scrollIntoView({ behavior: 'smooth' });

      // Reset form and variables
      purchaseForm.reset();
      items = [];
      renderItems();
      updateSubmitPurchaseState();
    });

    // Initialize
    updateAddItemButtonState();
    updateSubmitPurchaseState();
  })();
</script>
</body>
</html>

